[["index.html", "Term project draft Chapter 1 Introduction 1.1 Project goals 1.2 Project outline", " Term project draft Kipling Klimas 2021-04-30 Chapter 1 Introduction This project is focused on the relationship between a variety of environmental, topographic and derived variables and burn severity data for forest and non-forest environments in Utah. Burn severity is a measure of ecological change after wildfire, commonly assessed in terms of vegetation mortality or biomass loss, and is burn severity data is easily collected through remote sensing. Burn severity data is available from the The Monitoring Trends in Burn Severity (MTBS) databas, which containes burn severity data for wildfires &gt;1000 acres across the continental US. These data are available in the form of spatially explicit raster layers with continuous and categorical burn severity layers. The database used in this project contains fire behavior, structure, topographic, risk and vegetation ‘predictor’ variables for both forest and non-forest land along with burn severity data. 1.1 Project goals The specific goal of this project is to vizualize the relationship between burn severity and a variety of environmental variables in forest and non-forest enviornments. This includes creating plots that show: Burn severity vs. elevation Burn severity vs. canopy categories Burn severity vs. Vegetation type Burn severity vs. elevation with risk and canopy variables overlayed 1.2 Project outline The book is composed of the following chapters: Chapter 1: data description and structure Chapter 2: database creation Chapter 3: database connection’ Chapter 4: forest data visualization Chapter 5: non-forest data visualization "],["data.html", "Chapter 2 Data description and database structure", " Chapter 2 Data description and database structure Forest strcuture, topographic, and environmental variables are needed to create a machine learning model training dataset. Figure 1: databse structure for fire severity databse. This database contains tables for fire behavior, risk, topographic, vegetation and structural variables extracted from spatially explicit raster data layers for use as a training dataset in RandomForest (RF) models. The tables are linked to the severity table by the foreign key ‘severity_id’ which keeps track of both forest and non-forest severity datapoints. This database structure also allows data visualization between forest and non-forest landcover in Utah. "],["creation.html", "Chapter 3 Database creation", " Chapter 3 Database creation Start Install and open packages RSQLite install.packages(&quot;RSQLite&quot;) library(RSQLite) Establish database connection Connecting to the term_project database term_project &lt;- dbConnect(drv = RSQLite::SQLite(), &quot;C:/Users/A02345823/Box/Lab_Group/Kipling/Classes/WILD6900_EcoRepSci/Term_project/Term_project/database/severity.db&quot;) Create severity table Term project database creation based on structure in figure 1 dbExecute(term_project, &quot;CREATE TABLE severity( severity_id integer NOT NULL PRIMARY KEY, MTBSdNBR float, severity float );&quot;) Create forest behavior table dbExecute(term_project, &quot;CREATE TABLE forest_behavior( forest_behave_id integer NOT NULL PRIMARY KEY, severity_id float, flmlnA float, flmlnE float, flmlnH float, flmlnL float, flmlnM float, ftype_E float, ftype_H float, ftype_L float, ftype_M float, ros float, rosE float, rosH float, rosL float, rosM float, FOREIGN KEY(severity_id) REFERENCES severity(severity_id) );&quot;) Create forest risk table dbExecute(term_project, &quot;CREATE TABLE forest_risk( forest_risk_id integer NOT NULL PRIMARY KEY, severity_id float, fri float, fti float, sdr varchar(12), WHP float, FOREIGN KEY(severity_id) REFERENCES severity(severity_id) );&quot;) Create forest_structure table dbExecute(term_project, &quot;CREATE TABLE forest_structure( str_id integer NOT NULL PRIMARY KEY, severity_id float, wwacbd float, wwacbh float, wwacc float, wwach float, wwafuel13 float, wwafuel40 float, FOREIGN KEY(severity_id) REFERENCES severity(severity_id) );&quot;) Create forest_topo table dbExecute(term_project, &quot;CREATE TABLE forest_topo( forest_topo_id integer NOT NULL PRIMARY KEY, severity_id float, asp varchar(5), dem float, slope float, FOREIGN KEY(severity_id) REFERENCES severity(severity_id) );&quot;) Create forest_veg table dbExecute(term_project, &quot;CREATE TABLE forest_veg( forest_veg_id integer NOT NULL PRIMARY KEY, severity_id float, EVT varchar(60), SystGrp varchar(60), SAFSrm varchar(60), NVCSOrd varchar(16), NVCSclass varchar(25), NVCSsubclass varchar(40), SYSTMGRPPH varchar(30), FOREIGN KEY(severity_id) REFERENCES severity(severity_id) );&quot;) Create non-forest db tables Create non-forest behavior table dbExecute(term_project, &quot;CREATE TABLE nf_behavior( nf_behave_id integer NOT NULL PRIMARY KEY, severity_id float, flmlnA float, flmlnE float, flmlnH float, flmlnL float, flmlnM float, ftype_E float, ftype_H float, ftype_L float, ftype_M float, ros float, rosE float, rosH float, rosL float, rosM float, FOREIGN KEY(severity_id) REFERENCES severity(severity_id) );&quot;) Create non-forest risk table dbExecute(term_project, &quot;CREATE TABLE nf_risk( nf_risk_id integer NOT NULL PRIMARY KEY, severity_id float, fri float, fti float, sdr varchar(12), WHP float, FOREIGN KEY(severity_id) REFERENCES severity(severity_id) );&quot;) Create non-forest_structure table dbExecute(term_project, &quot;CREATE TABLE nf_structure( nf_str_id integer NOT NULL PRIMARY KEY, severity_id float, wwacbd float, wwacbh float, wwacc float, wwach float, wwafuel13 float, wwafuel40 float, FOREIGN KEY(severity_id) REFERENCES severity(severity_id) );&quot;) Create non-forest_topo table dbExecute(term_project, &quot;CREATE TABLE nf_topo( nf_topo_id integer NOT NULL PRIMARY KEY, severity_id float, asp varchar(5), dem float, slope float, FOREIGN KEY(severity_id) REFERENCES severity(severity_id) );&quot;) Create non-forest_veg table dbExecute(term_project, &quot;CREATE TABLE nf_veg( nf_veg_id integer NOT NULL PRIMARY KEY, severity_id float, EVT varchar(60), SystGrp varchar(60), SAFSrm varchar(60), NVCSOrd varchar(16), NVCSclass varchar(25), NVCSsubclass varchar(40), SYSTMGRPPH varchar(30), FOREIGN KEY(severity_id) REFERENCES severity(severity_id) );&quot;) "],["SQL.html", "Chapter 4 Database connection", " Chapter 4 Database connection Start Install package RSQLite install.packages(&quot;RSQLite&quot;) library(RSQLite) Establish datebase connection and create tables severity_db &lt;- dbConnect(drv = RSQLite::SQLite(), &quot;/Users/kiplingklimas/Box/Lab_Group/Kipling/Classes/WILD6900_EcoRepSci/Term_project/Term_project/database/severity.db&quot;) severity &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM severity;&quot;) forest_behavior &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM forest_behavior;&quot;) forest_risk &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM forest_risk;&quot;) forest_structure &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM forest_structure;&quot;) forest_topo &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM forest_topo;&quot;) forest_veg &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM forest_veg;&quot;) nf_behavior &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM nf_behavior;&quot;) nf_risk &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM nf_risk;&quot;) nf_structure &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM nf_structure;&quot;) nf_topo &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM nf_topo;&quot;) nf_veg &lt;- dbGetQuery(severity_db, &quot;SELECT * FROM nf_veg;&quot;) This is fire severity dataset shows the relationship between severity measurements and a variety of predictive variables including topographic, vegetation, structural and derived risk indices. Data was differentiated between forest and non-forest points to compare severity relationships between forests and non-forest landcover systems. "],["dataviz.html", "Chapter 5 Forest data visualization", " Chapter 5 Forest data visualization Install packages tidyverse, viridis and ggridges ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ── ## ✓ ggplot2 3.3.3 ✓ purrr 0.3.4 ## ✓ tibble 3.1.1 ✓ dplyr 1.0.5 ## ✓ tidyr 1.1.3 ✓ stringr 1.4.0 ## ✓ readr 1.4.0 ✓ forcats 0.5.1 ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() ## Loading required package: viridisLite sev &lt;- forest_topo %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% select(dem, severity) reg &lt;- lm(formula= severity ~ dem, data = sev) regs &lt;- predict(reg, se.fit = TRUE) regs &lt;- data.frame(mean = regs$fit, upr = regs$fit + 1.96 * regs$se.fit, lwr = regs$fit - 1.96 * regs$se.fit) forest_topo %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% select(dem, severity) %&gt;% ggplot(aes(x = dem, y = severity, color= dem)) + geom_point(alpha = 0.5) + scale_color_viridis_c(option = &quot;magma&quot;) + geom_line(aes(y = regs$mean, color = regs$mean)) + labs(y = &quot;Severity (dNBR)&quot;, x = &quot;Elevation (m)&quot;) + theme_light() Simple scatter plot of forest severity vs. elevation (m) forest_behavior %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% mutate(ftypeE = case_when( ftype_E == 3 ~ &quot;Surface&quot;, ftype_E == 4 ~ &quot;Passive&quot;, ftype_E == 5 ~ &quot;Passive&quot;, ftype_E == 6 ~ &quot;Active&quot;, ftype_E == 7 ~ &quot;Active&quot;, )) %&gt;% ggplot(aes(y = ftypeE, x = severity, fill = ftypeE)) + ggridges::geom_density_ridges(scale = 8, alpha = 0.5, show.legend = FALSE) + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(y = &quot;Fire type Extreme&quot;, x = &quot;Severity&quot;) + scale_color_viridis_d(option = &quot;magma&quot;) + theme_minimal() ## Picking joint bandwidth of 29.2 Density curves of fire type extreme by severity The variable FtypeE represents the fire type under extreme (99 percentile) weather scenarios. The three ‘types’ of fire in described by this variable are: 1. Surface - fire that burns surface fuels 2. Passive - fire that burns both surface and intermediate ladder fuels 3. Active - fire that burns in the canopy of the forest This density plot is of interest because it shows that Active fire type represents lower severity burned areas than Surface or Passive, which is contrary to a popular assumption that crown/canopy fire is associated with high-severity burned areas. forest_veg %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% filter(!is.na(severity_id)) %&gt;% ggplot(aes(x = NVCSsubclass, y = severity)) + geom_boxplot() + labs(y = &quot;Severity (dNBR)&quot;, x = &quot;Canopy type&quot;) + theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) Bar plot of canopy categories forest_topo %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% left_join(forest_risk, by = &quot;severity_id&quot;) %&gt;% select(dem, fri, severity) %&gt;% ggplot(aes(x = dem, y = severity, color = fri)) + geom_point(alpha = 0.5) + scale_color_viridis_c(option = &quot;magma&quot;) + labs(y = &quot;Severity (dNBR)&quot;, x = &quot;Elevation (m)&quot;) + theme_light() Elevation x severity x fire risk index forest_topo %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% left_join(forest_structure, by = &quot;severity_id&quot;) %&gt;% ggplot(aes(x = dem, y = severity, color = wwacc)) + geom_point(alpha = 0.5) + scale_color_viridis_c(option = &quot;magma&quot;) + labs(y = &quot;Severity (dNBR)&quot;, x = &quot;Elevation (m)&quot;) + theme_light() Elevation x severity x canopy closure forest_topo %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% left_join(forest_structure, by = &quot;severity_id&quot;) %&gt;% ggplot(aes(x = dem, y = severity, color = wwafuel40)) + geom_point(alpha = 0.5) + scale_color_viridis_c(option = &quot;magma&quot;) + labs(y = &quot;Severity (dNBR)&quot;, x = &quot;Elevation (m)&quot;) + theme_light() Elevation x severity x fuels40 Mean severity by vegetation type forest_veg %&gt;% pull(EVT) %&gt;% unique() ## [1] &quot;Southern Rocky Mountain Mesic Montane Mixed Conifer Forest and Woodland&quot; ## [2] &quot;Rocky Mountain Aspen Forest and Woodland&quot; ## [3] &quot;Colorado Plateau Pinyon-Juniper Woodland&quot; ## [4] &quot;Rocky Mountain Subalpine Dry-Mesic Spruce-Fir Forest and Woodland&quot; ## [5] &quot;Southern Rocky Mountain Ponderosa Pine Woodland&quot; ## [6] &quot;Inter-Mountain Basins Aspen-Mixed Conifer Forest and Woodland&quot; ## [7] &quot;Great Basin Pinyon-Juniper Woodland&quot; ## [8] &quot;Abies concolor Forest Alliance&quot; ## [9] &quot;Inter-Mountain Basins Curl-leaf Mountain Mahogany Woodland and Shrubland&quot; ## [10] &quot;Rocky Mountain Bigtooth Maple Ravine Woodland&quot; ## [11] &quot;Rocky Mountain Lodgepole Pine Forest&quot; ## [12] &quot;Southern Rocky Mountain Dry-Mesic Montane Mixed Conifer Forest and Woodland&quot; ## [13] &quot;Inter-Mountain Basins Juniper Savanna&quot; ## [14] &quot;Rocky Mountain Montane Riparian Systems&quot; ## [15] &quot;Inter-Mountain Basins Montane Riparian Systems&quot; ## [16] &quot;Rocky Mountain Subalpine-Montane Limber-Bristlecone Pine Woodland&quot; ## [17] &quot;Recently Disturbed Developed Upland Deciduous Forest&quot; ## [18] &quot;Developed-Upland Deciduous Forest&quot; ## [19] &quot;Rocky Mountain Foothill Limber Pine-Juniper Woodland&quot; ## [20] &quot;Middle Rocky Mountain Montane Douglas-fir Forest and Woodland&quot; ## [21] &quot;Developed-Upland Mixed Forest&quot; ## [22] &quot;Recently Disturbed Developed Upland Evergreen Forest&quot; ## [23] &quot;Developed-Upland Evergreen Forest&quot; ## [24] &quot;Southern Rocky Mountain Ponderosa Pine Savanna&quot; ## [25] &quot;Western Great Plains Floodplain Systems&quot; ## [26] &quot;Rocky Mountain Subalpine Mesic-Wet Spruce-Fir Forest and Woodland&quot; ## [27] &quot;Inter-Mountain Basins Subalpine Limber-Bristlecone Pine Woodland&quot; Lets check out the mean severity for each of these forest types. The red dashed line is the high-severity threshold. There are three forest types that have an average severity at or above the high-severity threshold of about 450 dNBR. The three forest types are: Rocky Mountain Subalpine Dry-Mesic Spruce-Fir Forest and Woodland Rocky Mountain Subalpine-Montane Limber-Bristlecone Pine Woodland Southern Rocky Mountain Mesic Montane Mixed Conifer Forest and Woodland forest_veg %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% group_by(EVT) %&gt;% summarise(mean_severity = mean(severity, na.rm = TRUE)) %&gt;% ggplot(aes(x = EVT, y = mean_severity)) + geom_hline(yintercept = 450, linetype = &quot;dashed&quot;, color = &quot;red&quot;) + geom_bar(stat = &quot;identity&quot;) + labs(x = &quot; &quot;, y = &quot;Mean severity&quot;) + theme_bw() + theme(axis.text.x = element_text(angle = 40, hjust = 1)) "],["ggplot.html", "Chapter 6 Non-forest data visualization", " Chapter 6 Non-forest data visualization Load packages Simple scatter plot of non-forest severity vs. elevation (m) sev &lt;- nf_topo %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% select(dem, severity) reg &lt;- lm(formula= severity ~ dem, data = sev) regs &lt;- predict(reg, se.fit = TRUE) regs &lt;- data.frame(mean = regs$fit, upr = regs$fit + 1.96 * regs$se.fit, lwr = regs$fit - 1.96 * regs$se.fit) nf_topo %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% select(dem, severity) %&gt;% ggplot(aes(x = dem, y = severity, color= dem)) + geom_point(alpha = 0.5) + scale_color_viridis_c(option = &quot;magma&quot;) + geom_line(aes(y = regs$mean, color = regs$mean)) + labs(y = &quot;Severity (dNBR)&quot;, x = &quot;Elevation (m)&quot;) + theme_light() nf_veg %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% filter(!is.na(severity_id)) %&gt;% ggplot(aes(x = NVCSsubclass, y = severity)) + geom_boxplot() + labs(y = &quot;Severity (dNBR)&quot;, x = &quot;Canopy type&quot;) + theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) Bar plot of non-forest canopy categories. nf_topo %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% left_join(nf_risk, by = &quot;severity_id&quot;) %&gt;% select(dem, fri, severity) %&gt;% ggplot(aes(x = dem, y = severity, color = fri)) + geom_point(alpha = 0.5) + scale_color_viridis_c(option = &quot;magma&quot;) + labs(y = &quot;Severity (dNBR)&quot;, x = &quot;Elevation (m)&quot;) + theme_light() Elevation x severity x fire risk index nf_topo %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% left_join(nf_structure, by = &quot;severity_id&quot;) %&gt;% ggplot(aes(x = dem, y = severity, color = wwacc)) + geom_point(alpha = 0.5) + scale_color_viridis_c(option = &quot;magma&quot;) + labs(y = &quot;Severity (dNBR)&quot;, x = &quot;Elevation (m)&quot;) + theme_light() Elevation x severity x canopy closure. This figures illustrates that non-forest landcover has no discernable canopy. nf_topo %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% left_join(nf_structure, by = &quot;severity_id&quot;) %&gt;% ggplot(aes(x = dem, y = severity, color = wwafuel40)) + geom_point(alpha = 0.5) + scale_color_viridis_c(option = &quot;magma&quot;) + labs(y = &quot;Severity (dNBR)&quot;, x = &quot;Elevation (m)&quot;) + theme_light() Elevation x severity x fuels40 Mean severity by vegetation type nf_veg %&gt;% pull(EVT) %&gt;% unique() ## [1] &quot;Inter-Mountain Basins Mixed Salt Desert Scrub&quot; ## [2] &quot;Rocky Mountain Gambel Oak-Mixed Montane Shrubland&quot; ## [3] &quot;Herbaceous Semi-dry&quot; ## [4] &quot;Inter-Mountain Basins Big Sagebrush Shrubland&quot; ## [5] &quot;Introduced Upland Vegetation-Annual Grassland&quot; ## [6] &quot;Artemisia tridentata ssp. vaseyana Shrubland Alliance&quot; ## [7] &quot;NASS-Fallow/Idle Cropland&quot; ## [8] &quot;Sonora-Mojave Semi-Desert Chaparral&quot; ## [9] &quot;Inter-Mountain Basins Big Sagebrush Steppe&quot; ## [10] &quot;Quercus gambelii Shrubland Alliance&quot; ## [11] &quot;Colorado Plateau Mixed Low Sagebrush Shrubland&quot; ## [12] &quot;Inter-Mountain Basins Greasewood Flat&quot; ## [13] &quot;Rocky Mountain Subalpine-Montane Mesic Meadow&quot; ## [14] &quot;Great Basin Xeric Mixed Sagebrush Shrubland&quot; ## [15] &quot;NASS-Close Grown Crop&quot; ## [16] &quot;Inter-Mountain Basins Semi-Desert Shrub-Steppe&quot; ## [17] &quot;Colorado Plateau Pinyon-Juniper Woodland&quot; ## [18] &quot;Rocky Mountain Foothill Limber Pine-Juniper Woodland&quot; ## [19] &quot;Inter-Mountain Basins Semi-Desert Grassland&quot; ## [20] &quot;Inter-Mountain Basins Montane Sagebrush Steppe&quot; ## [21] &quot;Great Basin Semi-Desert Chaparral&quot; ## [22] &quot;Inter-Mountain Basins Aspen-Mixed Conifer Forest and Woodland&quot; ## [23] &quot;Developed-Upland Shrubland&quot; ## [24] &quot;Agriculture-Pasture and Hay&quot; ## [25] &quot;Rocky Mountain Lower Montane-Foothill Shrubland&quot; ## [26] &quot;Recently Disturbed Pasture and Hayland&quot; ## [27] &quot;Introduced Upland Vegetation-Perennial Grassland and Forbland&quot; ## [28] &quot;Developed-Upland Herbaceous&quot; ## [29] &quot;Inter-Mountain Basins Curl-leaf Mountain Mahogany Woodland and Shrubland&quot; ## [30] &quot;Abies concolor Forest Alliance&quot; ## [31] &quot;North American Warm Desert Riparian Systems&quot; ## [32] &quot;Colorado Plateau Blackbrush-Mormon-tea Shrubland&quot; ## [33] &quot;Introduced Upland Vegetation-Annual and Biennial Forbland&quot; ## [34] &quot;Barren&quot; ## [35] &quot;Columbia Plateau Low Sagebrush Steppe&quot; ## [36] &quot;Inter-Mountain Basins Juniper Savanna&quot; ## [37] &quot;Wyoming Basins Dwarf Sagebrush Shrubland and Steppe&quot; ## [38] &quot;Developed-Roads&quot; ## [39] &quot;Mojave Mid-Elevation Mixed Desert Scrub&quot; ## [40] &quot;Coleogyne ramosissima Shrubland Alliance&quot; ## [41] &quot;Southern Rocky Mountain Mesic Montane Mixed Conifer Forest and Woodland&quot; ## [42] &quot;Rocky Mountain Alpine/Montane Sparsely Vegetated Systems&quot; ## [43] &quot;Inter-Mountain Basins Mat Saltbush Shrubland&quot; ## [44] &quot;Great Basin Pinyon-Juniper Woodland&quot; ## [45] &quot;Southern Rocky Mountain Montane-Subalpine Grassland&quot; ## [46] &quot;Arctostaphylos patula Shrubland Alliance&quot; ## [47] &quot;Rocky Mountain Subalpine Dry-Mesic Spruce-Fir Forest and Woodland&quot; ## [48] &quot;Inter-Mountain Basins Sparsely Vegetated Systems&quot; ## [49] &quot;Mogollon Chaparral&quot; ## [50] &quot;Columbia Plateau Steppe and Grassland&quot; ## [51] &quot;Herbaceous Wetlands&quot; ## [52] &quot;Rocky Mountain Montane Riparian Systems&quot; ## [53] &quot;Quarries-Strip Mines-Gravel Pits&quot; ## [54] &quot;Rocky Mountain Alpine Dwarf-Shrubland&quot; ## [55] &quot;Introduced Riparian Vegetation&quot; ## [56] &quot;Southern Rocky Mountain Dry-Mesic Montane Mixed Conifer Forest and Woodland&quot; ## [57] &quot;Southern Colorado Plateau Sand Shrubland&quot; ## [58] &quot;Recently Burned-Herb and Grass Cover&quot; ## [59] &quot;Open Water&quot; ## [60] &quot;NASS-Row Crop&quot; ## [61] &quot;Sonora-Mojave Creosotebush-White Bursage Desert Scrub&quot; ## [62] &quot;Recently Disturbed Developed Upland Shrubland&quot; ## [63] &quot;Agriculture-Cultivated Crops and Irrigated Agriculture&quot; ## [64] &quot;Southern Rocky Mountain Ponderosa Pine Woodland&quot; ## [65] &quot;Rocky Mountain Subalpine/Upper Montane Riparian Systems&quot; Lets check out the mean severity for each of these forest types. The red dashed line is the high-severity threshold. nf_veg %&gt;% left_join(severity, by = &quot;severity_id&quot;) %&gt;% group_by(EVT) %&gt;% summarise(mean_severity = mean(severity, na.rm = TRUE)) %&gt;% ggplot(aes(x = EVT, y = mean_severity)) + geom_hline(yintercept = 450, linetype = &quot;dashed&quot;, color = &quot;red&quot;) + geom_bar(stat = &quot;identity&quot;) + labs(x = &quot; &quot;, y = &quot;Mean severity&quot;) + theme_bw() + theme(axis.text.x = element_text(angle = 40, hjust = 1)) "],["references.html", "References", " References "]]
